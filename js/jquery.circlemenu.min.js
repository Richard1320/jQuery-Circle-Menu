/*!
 * jQuery Circle Menu
 * https://github.com/Richard1320/jQuery-Circle-Menu
 *
 * Author
 * Richard Hung
 * http://www.magicmediamuse.com/
 *
 * Version
 * 1.0.0
 *
 * Copyright (c) 2018 Richard Hung.
 *
 * License
 * jQuery Circle Menu by Richard Hung is licensed under a MIT License.
 * http://opensource.org/licenses/MIT
 */

!function(t){"use strict";var e={x:0,y:0},i={init:function(e){var i={defaultRotation:0,drawLine:!1,dragMouse:!1,dragTouch:!1,dragDirection:"horizontal",lockDirection:!1,focusRotate:!1},o=t.extend({},i,e);return this.each(function(){var e=t(this),i=e.children(),n=i.children();e.addClass("circle-menu").data("settings",o).data("currentOffset",o.defaultRotation),i.addClass("circle-menu__circle").css("transform","rotate("+o.defaultRotation+"deg)"),n.addClass("circle-menu__circle__item").wrapInner('<div class="circle-menu__circle__item__inner"></div>'),e.circleMenu("update"),(o.dragMouse||o.dragTouch)&&("horizontal"==o.dragDirection?e.addClass("is-draggable-horizontal"):e.addClass("is-draggable-vertical"),e.circleMenu("bindDrag")),i.append('<svg class="circle-menu__circle__svg" viewbox="0 0 100 100"><circle class="circle-menu__circle__svg__circle" cx="50" cy="50" r="50" transform="rotate(-90 50 50)" /><circle class="circle-menu__circle__svg__line" cx="50" cy="50" r="50" transform="rotate(-90 50 50)" /></svg>')})},update:function(){return this.each(function(){var e=t(this),i=e.find(".circle-menu__circle__item"),o=e.data("settings"),n=360/i.length;i.each(function(){var e=t(this),i=e.index()*n;e.css("transform","rotate("+i+"deg)").data("offsetRotate",i)}),o.lockDirection&&e.circleMenu("reLockChildren"),e.circleMenu("directionClasses")})},reLockChildren:function(){var e=this.data("currentOffset");return this.find(".circle-menu__circle__item").each(function(){var i=t(this).data("offsetRotate");t(this).children(".circle-menu__circle__item__inner").css("transform","rotate("+-1*(i+e)+"deg)")})},directionClasses:function(){var e=this,i=e.find(".circle-menu__circle__item"),o=e.data("currentOffset");i.removeClass("position--top position--left position--right position--bottom position--bottom-right position--top-left position--top-left position--top-right position--bottom-left position--bottom-right"),i.each(function(){var e=t(this),i=e.data("offsetRotate"),n=o+i;n<0&&(n+=360),n>360&&(n-=360),n>=337&&n<=360||n>=0&&n<22?e.addClass("position--top"):n>=22&&n<67?e.addClass("position--top-right"):n>=67&&n<112?e.addClass("position--right"):n>=112&&n<157?e.addClass("position--bottom-right"):n>=157&&n<202?e.addClass("position--bottom"):n>=202&&n<247?e.addClass("position--bottom-left"):n>=247&&n<292?e.addClass("position--left"):n>=292&&n<337&&e.addClass("position--top-left")})},bindDrag:function(){var i=this.data("settings"),o="",n="",c="";return i.dragMouse&&(o+="mousedown ",n+="mousemove ",c+="mouseup "),i.dragTouch&&(o+="touchstart ",n+="touchmove ",c+="touchend touchcancel "),this.on(o,function(i){var o=t(this),r=o.data("settings"),a=i;"touchstart"==i.type&&(a=i.originalEvent.touches[0]||i.originalEvent.changedTouches[0]),e.x=a.pageX-o.offset().left,e.y=a.pageY-o.offset().top,o.on(n,function(t){var i=t;"touchmove"==t.type&&(i=t.originalEvent.touches[0]||t.originalEvent.changedTouches[0]);var n=i.pageX-o.offset().left,c=i.pageY-o.offset().top,a="horizontal"==r.dragDirection?n-e.x:c-e.y,s=o.data("currentOffset")+a;e.x=n,e.y=c,o.circleMenu("rotateTo",s),t.preventDefault()}),t(window).one(c,function(){o.off(n)})}),this.find(".circle-menu__circle__item").on(o,function(t){t.stopPropagation()}),this},rotateTo:function(e){return this.each(function(){var i=t(this),o=i.data("settings"),n=i.children(".circle-menu__circle");e>360&&(e-=360),e<0&&(e+=360),i.data("currentOffset",e),n.css("transform","rotate("+e+"deg)"),o.lockDirection&&i.circleMenu("reLockChildren"),i.circleMenu("directionClasses")})},focus:function(e){return this.each(function(){var i=t(this),o=i.children(".circle-menu__circle"),n=i.data("settings"),c=i.find(".circle-menu__circle__item"),r=c.length,a=315-315/r*e,s=360/r*e*-1+n.defaultRotation;c.removeClass("is-active").eq(e).addClass("is-active"),n.drawLine&&i.find(".circle-menu__circle__svg__line").css("stroke-dashoffset",a),n.focusRotate&&(o.css("z-index",i.data("currentOffset")),o.animate({zIndex:s},{step:function(t,e){i.circleMenu("rotateTo",t)},duration:1e3}))})},destroy:function(){return this.each(function(){alert("destroy")})}};t.fn.circleMenu=function(e){return i[e]?i[e].apply(this,Array.prototype.slice.call(arguments,1)):"object"!=typeof e&&e?void t.error("Method "+e+" does not exist on jQuery.circleMenu"):i.init.apply(this,arguments)}}(jQuery);